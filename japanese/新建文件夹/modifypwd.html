<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ taglib prefix="s" uri="/struts-tags" %>
<s:i18n name="i18n.modifypwd">
<%
String path = request.getContextPath();
String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";
%>

<!DOCTYPE html>
<!-- saved from url=(0038)${appPath}/uc/modifypwd.aspx -->
<html xmlns="http://www.w3.org/1999/xhtml"><head id="Head1">
<base href="<%=basePath%>">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
	<s:text name="update_password" />
</title><link rel="stylesheet" href="${appPath}/static/www/css/base.css" />
<link rel="stylesheet" href="${appPath}/static/www/css/order_list.css" />
<link rel="stylesheet" href="${appPath}/static/www/css/help.css" />
    <script src="${appPath}/static/www/js/mh_dialog.js"></script>
    <script type="text/javascript">
        function submits() {
        	hidError("txtOldPwd");
        	hidError("txtPwd");
        	hidError("txtPwd2");
            var oldpwd = $.trim($("#txtOldPwd").val());
            if (oldpwd == "") {
                $("#txtOldPwd").focus();
                showError("txtOldPwd",'<s:text name="msg1" />');
                return false;
            }

            var pwd = $.trim($("#txtPwd").val());
            if (pwd == "") {
                $("#txtPwd").focus();
                showError("txtPwd",'<s:text name="msg2" />');
                return false;
            }

            var pwd2 = $.trim($("#txtPwd2").val());
            if (pwd2 == "") {
                $("#txtPwd2").focus();
                showError("txtPwd2",'<s:text name="msg3" />');
                return false;
            }

            if (pwd != pwd2) {
                alert('<s:text name="msg4" />');
                return false;
            }

            $.ajax({
                type: "POST",
                url: "${appPath}/personal/updateModifypwdView.do",
                dataType: "json",
                data: { oldpwd: oldpwd,pwd:pwd},
                async: false,
                success: function (data) {
                    if (data.result == "pwderror") {
                        $("#oldPwd").focus();
                        showError("txtOldPwd",'<s:text name="msg5" />')
                    }else if(data.result == "success"){
                    	window.location.href="${appPath}/website/websiteView.do"
                    }else if(data.result == "error"){
                    	alert('<s:text name="msg6" />');
                    }
                },
                error: function () {
                    alert('<s:text name="msg7" />');
                }
            });
        }
      //错误
        function showError(elementId, msg) {
            $("#" + elementId + "Msg").html(msg);
        }
        //正确
        function hidError(elementId) {
            $("#" + elementId + "Msg").html("");
        }
    </script>

</head>
<body style="background-color: #eee;" onload="loginValidate();">
        <!-- 头部 -->
      <%@ include file="bai-head.jsp" %>

        <!---->
        <!--内容-->
        <div class="wrap">
            <div class="content" id="content">
                <div class="home_body_l clearfix">
                   <ul class="pact-nav">
                        <li class="active">
                            <a href="${appPath}/personal/personalView.do"><s:text name="user_info" /></a>
                        </li>
                        <li>
                            <a href="${appPath}/personal/modifypwdView.do"><s:text name="update_password" /></a>
                        </li>
                        <li>
                            <a href="${appPath }/webOrderList/queryWebOrderList.do"><s:text name="hotel_order" /></a>
                        </li>
                        <li>
                            <a href="${appPath }/webOrderList/queryTicketOrderNum.do"><s:text name="ticket_order" /></a>
                        </li>
                    </ul>
                </div>
                <div class="home_body_r clearfix">
                    <div class="pact_box pact_4">
                        <h3><s:text name="update_password" /></h3>
                        <div class="pact_content aboutLY">
                            <p>
                                <label><s:text name="old_p" />：</label><input name="txtOldPwd" type="password" id="txtOldPwd" class="inTxt" />
                                <span style="color:red;" id="txtOldPwdMsg"></span>
                            </p>

                            <p>
                                <label><s:text name="new_p" />：</label><input name="txtPwd" type="password" id="txtPwd" class="inTxt" />
                                <span style="color:red;" id="txtPwdMsg"></span>
                            </p>

                            <p>
                                <label><s:text name="new_p2" />：</label><input name="txtPwd2" type="password" id="txtPwd2" class="inTxt" />
                                <span style="color:red;" id="txtPwd2Msg"></span>
                            </p>

                            <p>
                                <label></label>
                                <input type="submit" name="btnSubmit" value="<s:text name="sub" />" onclick="submits();" id="btnSubmit" class="redBtn w_60" />
                            </p>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <!--end-->
        
 <%@ include file="footer.jsp" %>
<!---->
<script type="text/javascript">
    (function () {
        var hm = document.createElement("script");
        hm.src = "${appPath}/static/www/js/stat.js";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
    </form>
</body>
</html>
</s:i18n>
